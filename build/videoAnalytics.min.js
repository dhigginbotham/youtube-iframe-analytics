!function(e){if("object"==typeof exports)module.exports=e();else if("function"==typeof define&&define.amd)define(e);else{var t;"undefined"!=typeof window?t=window:"undefined"!=typeof global?t=global:"undefined"!=typeof self&&(t=self),t.videoAnalytics=e()}}(function(){return function e(t,n,a){function r(i,d){if(!n[i]){if(!t[i]){var s="function"==typeof require&&require;if(!d&&s)return s(i,!0);if(o)return o(i,!0);throw new Error("Cannot find module '"+i+"'")}var u=n[i]={exports:{}};t[i][0].call(u.exports,function(e){var n=t[i][1][e];return r(n?n:e)},u,u.exports,e,t,n,a)}return n[i].exports}for(var o="function"==typeof require&&require,i=0;i<a.length;i++)r(a[i]);return r}({1:[function(e,t,n){var a=e("./helpers"),r=e("./mon")(!1),o=a.attr,i=a.safeParse,d={},s={};s.videos={},s.events={},s.queue=[],s.loaded=!1,s.init=function(){s.collectDom(),s.queue.length&&s.injectScripts()},s.attachEvents=function(e,t,n){s.videos[e]||(s.videos[e]={}),s.videos[e].events||(s.videos[e].events={}),s.videos[e].events[t]instanceof Array||(s.videos[e].events[t]=[]),s.videos[e].events[t].push(n)},s.attachVideos=function(e){if(s.loaded)for(var t;t=e.shift();)t.player=new YT.Player(t.el,t.opts),t.player._id=t.opts.videoId},s.collectDom=function(e){d.setDebug();for(var t=document.querySelectorAll("[data-yt-analytics]"),n=0;n<t.length;++n)s.referenceObject(t[n])},s.externalApiReady=function(){s.loaded=!0,s.attachVideos(s.queue)},s.injectScripts=function(e){if(!s.scriptInclude){window.onYouTubeIframeAPIReady=s.externalApiReady;var t=document.getElementsByTagName("script")[0];s.scriptInclude=document.createElement("script"),"function"==typeof e&&(s.scriptInclude.setAttribute("async",!0),s.scriptInclude.addEventListener("load",e,!1)),s.scriptInclude.setAttribute("src","//www.youtube.com/iframe_api"),t.parentNode.insertBefore(s.scriptInclude,t)}},s.processEvents=function(e,t,n,a){var o=s.videos[t].events[e],i=s.videos[t].player;s.videos[t].currentState=n,s.videos[t].opts.title==t&&(s.videos[t].opts.title=i.getVideoData().title?i.getVideoData().title:t);var d={currentTime:Math.floor(i.getCurrentTime()),duration:Math.floor(i.getDuration()),event:e,id:t,title:s.videos[t].opts.title,state:s.videos[t].currentState,muted:i.isMuted(),ms:(new Date).getTime()};if(s.videos[t].events[e])for(var u=0;u<o.length;++u)o[u](a,d);r.log(d)},s.referenceObject=function(e){var t={},n=o(e);t.videoId=n("data-yt-analytics"),null==n("data-yt-tracked")&&(n("data-yt-tracked",!0),t.width=n("data-yt-width")?n("data-yt-width"):640,t.height=n("data-yt-height")?n("data-yt-height"):390,t.playerVars=n("data-yt-vars")?i(n("data-yt-vars")):null,t.title=n("data-yt-title")?n("data-yt-title"):t.videoId,t.events={onReady:s.events.ready,onStateChange:s.events.stateChange,onError:s.events.error,onPlaybackQualityChange:s.events.playbackQualityChange,onPlaybackRateChange:s.events.playbackRateChange,onApiChange:s.events.apiChange},s.videos.hasOwnProperty(t.videoId)||(s.videos[t.videoId]={}),s.videos[t.videoId].opts=t,s.videos[t.videoId].el=e,s.queue.push(s.videos[t.videoId]))},s.events.apiChange=function(e){s.processEvents("apiChange",e.target._id,"apiChange",e)},s.events.error=function(e){var t="unrecognized error";2==e.data||100==e.data?t="invalid videoId":5==e.data?t="html5 player error":(101==e.data||150==e.data)&&(t="embedding forbidden"),s.processEvents("error",e.target._id,t,e)},s.events.playbackRateChange=function(e){s.processEvents("playbackRateChange",e.target._id,"playbackRateChange",e)},s.events.playbackQualityChange=function(e){s.processEvents("playbackQualityChange",e.target._id,"playbackQualityChange",e)},s.events.ready=function(e){s.processEvents("ready",e.target._id,"ready",e)},s.events.stateChange=function(e){var t="unknown";e.data===YT.PlayerState.BUFFERING?t="buffering":e.data===YT.PlayerState.CUED?t="cued":e.data===YT.PlayerState.ENDED?t="ended":e.data===YT.PlayerState.PAUSED?t="paused":e.data===YT.PlayerState.PLAYING?t="playing":e.data===YT.PlayerState.UNSTARTED&&(t="unstarted"),s.processEvents("stateChange",e.target._id,t,e)},d.on=function(e,t,n){var a=!1,r=e;if(e instanceof Array&&(a=e.length>0,r=e.shift()),"*"===t){var o=Object.keys(s.videos);if(!o.length)return d;for(var i=0;i<o.length;++i)s.attachEvents(o[i],r,n)}else s.attachEvents(t,r,n);return a?d.on(e,t,n):d},d.setDebug=function(e){var t=document.querySelector("[data-yt-debug]");if(e="boolean"==typeof e?e:null,t){var n=o(t);d.debug="true"==n("data-yt-debug")}return null!==e&&(d.debug=e),r.debug=d.debug,d.logs=d.debug?r.history:[],d},d.track=function(){return s.collectDom(),s.queue.length&&(s.injectScripts(),s.attachVideos(s.queue)),d},d.videos=s.videos,document.addEventListener("DOMContentLoaded",s.init,!1),t.exports=d},{"./helpers":2,"./mon":3}],2:[function(e,t,n){var a=function(e){return"undefined"!=typeof e?function(t,n){return"undefined"==typeof n?e.getAttribute(t):"rm"==n?e.removeAttribute(t):e.setAttribute(t,n)}:null},r=function(e){var t=null;try{t=JSON.parse(e)}catch(n){}return t};t.exports={attr:a,safeParse:r}},{}],3:[function(e,t,n){var a=function(e){return this instanceof a?(this.debug=e,this.history=[],this):new a(e)};a.prototype.log=function(){var e=Array.prototype.slice.call(arguments);return this.history.push(e),this.debug&&"undefined"!=typeof window.console&&console.log&&(1===e.length&&"object"==typeof e[0]&&(e=JSON.stringify(e[0],null,2)),console.log(e)),this},t.exports=a},{}]},{},[1])(1)});