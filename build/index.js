!function(e){if("object"==typeof exports)module.exports=e();else if("function"==typeof define&&define.amd)define(e);else{var t;"undefined"!=typeof window?t=window:"undefined"!=typeof global?t=global:"undefined"!=typeof self&&(t=self),t.videoAnalytics=e()}}(function(){return function e(t,n,r){function a(d,o){if(!n[d]){if(!t[d]){var u="function"==typeof require&&require;if(!o&&u)return u(d,!0);if(i)return i(d,!0);throw new Error("Cannot find module '"+d+"'")}var s=n[d]={exports:{}};t[d][0].call(s.exports,function(e){var n=t[d][1][e];return a(n?n:e)},s,s.exports,e,t,n,r)}return n[d].exports}for(var i="function"==typeof require&&require,d=0;d<r.length;d++)a(r[d]);return a}({1:[function(e,t,n){var r=e("./helpers"),a=r.attr,i={},d={};d.videos={},d.events={},d.queue=[],i.init=function(){d.collectDom(),d.queue.length&&d.injectScripts()},i.on=function(e,t,n){return d.videos[t]&&(d.videos[t].events[e]instanceof Array||(d.videos[t].events[e]=[]),d.videos[t].events[e].push(n)),i},i.attachVideos=function(){for(var e;e=d.queue.shift();)e.player=new YT.Player(e.el,e.opts),e.player._id=e.opts.videoId},d.collectDom=function(){for(var e=document.querySelectorAll("[data-yt-analytics]"),t=0;t<e.length;++t)d.referenceObject(e[t])},d.referenceObject=function(e){var t={},n=a(e);t.videoId=n("data-yt-analytics")?n("data-yt-analytics"):null,t.videoId&&null==n("data-yt-tracked")&&(n("data-yt-tracked",!0),t.width=n("data-yt-width")?n("data-yt-width"):640,t.height=n("data-yt-height")?n("data-yt-height"):390,t.playerVars=n("data-yt-vars")?n("data-yt-vars"):null,t.title=n("data-yt-title")?n("data-yt-title"):t.videoId,t.events=d.setupEvents(),d.videos[t.videoId]={opts:t,el:e,events:{}},d.queue.push(d.videos[t.videoId]))},d.setupEvents=function(){var e={};return e.onReady=d.events.ready,e.onStateChange=d.events.stateChange,e.onError=d.events.error,e},d.events.ready=function(e){if(d.videos[e.target._id].events.ready){var t=d.videos[e.target._id].events.ready;return t.forEach(function(t){return t(e)})}},d.events.stateChange=function(e){var t="unstarted";if(e.data===YT.PlayerState.BUFFERING?t="buffering":e.data===YT.PlayerState.CUED?t="cued":e.data===YT.PlayerState.ENDED?t="ended":e.data===YT.PlayerState.PAUSED?t="paused":e.data===YT.PlayerState.PLAYING&&(t="playing"),d.videos[e.target._id].events.stateChange){var n=d.videos[e.target._id].events.stateChange,r=d.videos[e.target._id].player;n.forEach(function(n){return n({state:t,currentTime:r.getCurrentTime(),duration:r.getDuration(),epoc:(new Date).getTime()},e)})}},d.events.error=function(e){var t="invalid videoId";if(2==e.data||100==e.data||(5==e.data?t="html5 player error":(101==e.data||150==e.data)&&(t="embedding forbidden")),d.videos[e.target._id].events.error){var n=d.videos[e.target._id].events.error,r=d.videos[e.target._id].player;n.forEach(function(n){return n({state:t,currentTime:r.getCurrentTime(),duration:r.getDuration(),epoc:(new Date).getTime()},e)})}},d.injectScripts=function(e){if(!d.scriptInclude){window.onYouTubeIframeAPIReady=i.attachVideos;var t=document.getElementsByTagName("script")[0];d.scriptInclude=document.createElement("script"),"function"==typeof e&&(d.scriptInclude.setAttribute("async",!0),d.scriptInclude.addEventListener("load",e,!1)),d.scriptInclude.setAttribute("src","//www.youtube.com/iframe_api"),t.parentNode.insertBefore(d.scriptInclude,t)}},document.addEventListener("DOMContentLoaded",i.init,!1),t.exports=i},{"./helpers":2}],2:[function(e,t,n){n.attr=function(e){return"undefined"!=typeof e?function(t,n){return"undefined"==typeof n?e.getAttribute(t):"rm"==n?e.removeAttribute(t):e.setAttribute(t,n)}:null}},{}]},{},[1])(1)});